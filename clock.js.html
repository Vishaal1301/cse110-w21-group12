<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: clock.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: clock.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Clock module
 * @module modules/clock
*/

// Timer setting variables
const POMO_CYCLES = 5;
let autoCycle = true;
let sessionLengths = [1500, 300, 1500, 300, 1500, 300, 1500, 300, 1500, 900];
let sessionNum= 0;

// Global timer variables
let isCountdown = false;
let countdown;

// Start the timer
function startTimer(clock, callback) {
    isCountdown = true;
    let timer = sessionLengths[sessionNum] - 1;
    countdown = setInterval(() => {

        // Update the HTML text
        clock.innerHTML = secondsToString(timer);

        if (--timer &lt; 0) {
            stopTimer(clock, false, callback);

            // If autoCycle is enabled, restart the timer immediately
            if (autoCycle)
                startTimer(clock, callback);
        }

    }, 1000);
}

// Stop the timer
function stopTimer(clock, reset, callback) {
    isCountdown = false;
    if(reset){
        sessionNum = 0;
    }else{
        sessionNum= ++sessionNum >= sessionLengths.length ? 0 : sessionNum;
    }

    clearInterval(countdown);

    const state = sessionNum == POMO_CYCLES*2 - 1? 'Long Break' : sessionNum% 2 == 0 ? "Focus Session" : "Short Break";
    callback(state);
    clock.innerHTML = secondsToString(sessionLengths[sessionNum]);
}

// Given a number in seconds, return the string equivalent in time format
function secondsToString(time) {
    let minutes, seconds;

    minutes = parseInt(time / 60, 10);
    seconds = parseInt(time % 60, 10);

    minutes = minutes &lt; 10 ? "0" + minutes : minutes;
    seconds = seconds &lt; 10 ? "0" + seconds : seconds;

    return minutes + ":" + seconds;
}


/**
 * Update the timer settings, and also resets all sessions. 
 * @param {object} clock - The HTML element for the clock
 * @param {number} focusLength - The length of the focus session, in seconds
 * @param {number} shortBreakLength - The length of the short break length, in seconds
 * @param {number} longBreakLength - The length of the long break length, in seconds
 * @returns {boolean} True if the settings were updated, false if some error occured
 */
function updateTimerSettings(clock, focusLength, shortBreakLength, longBreakLength) {

    // Do nothing if the timer is currently on
    if(isCountdown)
        return false;

    sessionNum= 0;
    clock.innerHTML = sessionLengths[sessionNum];

    sessionLengths = [];
    for (let i = 0; i &lt; POMO_CYCLES; i++) {
        sessionLengths.push(focusLength);
        if (i &lt; POMO_CYCLES - 1)
            sessionLengths.push(shortBreakLength);
        else
            sessionLengths.push(longBreakLength);
    }
    clock.innerHTML = secondsToString(sessionLengths[sessionNum]);

    return true;
}

/**
 * When the button is clicked, starts or stops timer based on timer state
 * @param {object} clock - The HTML element for the clock
 * @param {function} callback - Callback gets called everytime the timer stops, or when the state changes
 */
function startStopTimer(clock, callback) {
    if (!isCountdown) {
        startTimer(clock, callback);
    }
    else {
        const reset = true;
        stopTimer(clock, reset, callback);
    }
}

export { startStopTimer, updateTimerSettings, isCountdown };</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-modules_clock.html">modules/clock</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Sat Feb 20 2021 03:10:57 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
